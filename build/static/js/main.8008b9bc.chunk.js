(this["webpackJsonpro-pocket"]=this["webpackJsonpro-pocket"]||[]).push([[0],{15:function(e,t,n){},16:function(e,t,n){},18:function(e,t,n){},20:function(e,t,n){"use strict";n.r(t);var r=n(1),s=n.n(r),c=n(9),o=n.n(c),i=(n(15),n(16),n(7)),a=n.n(i),u=n(10),l=n(8),m=n(3),d=n(2),g=(n(18),n(0)),j=function(e){return Object(g.jsxs)("div",{children:["Unknown ",e.tag,": ",JSON.stringify(e.msg)]})},f=function(e){return Object(g.jsxs)("div",{children:["(Ignored ",e.tag,")"]})},b=function(e){var t,n,r,s;return Object(g.jsxs)("div",{className:e.deleted?"deleted":"",children:[Object(g.jsx)("img",{className:"avatar",src:"https://source.48.cn".concat(null===(t=e.user)||void 0===t?void 0:t.avatar),alt:""}),(null===(n=e.user)||void 0===n?void 0:n.pfUrl)?Object(g.jsx)("img",{className:"avatar-overlay",src:"https://source.48.cn".concat(null===(r=e.user)||void 0===r?void 0:r.pfUrl),alt:""}):null,null===(s=e.user)||void 0===s?void 0:s.nickName,new Date(e.msg.time).toLocaleString(),Object(g.jsx)("br",{}),e.children]})},O=function(e){if("in"!==e.msg.flow)return Object(g.jsx)(j,{tag:"flow",msg:e.msg});var t=!1;if("admin"===e.msg.from||"Server"===e.msg.fromClientType){if("admin"!==e.msg.from||"Server"!==e.msg.fromClientType)return Object(g.jsx)(j,{tag:"adminServer",msg:e.msg});t=!0}if(!e.msg.custom)return Object(g.jsx)(j,{tag:"custom",msg:e.msg});var n=e.msg.custom;return"TEXT"===n.messageType?Object(g.jsx)(v,{msg:e.msg,custom:n,deleted:e.deleted}):t&&"PRESENT_NORMAL"===n.messageType?Object(g.jsx)(f,{tag:"adminServer PRESENT_NORMAL"}):t&&"PRESENT_FULLSCREEN"===n.messageType?Object(g.jsx)(f,{tag:"adminServer PRESENT_FULLSCREEN"}):t&&"RECIEVE_GIFT_EVENT"===n.messageType?Object(g.jsx)(f,{tag:"adminServer RECIEVE_GIFT_EVENT"}):t&&"DELETE"===n.messageType?Object(g.jsx)(f,{tag:"adminServer DELETE"}):"PRESENT_TEXT"===n.messageType?Object(g.jsx)(p,{msg:e.msg,custom:n}):"EXPRESSIMAGE"===n.messageType?Object(g.jsx)(x,{msg:e.msg,custom:n}):"REPLY"===n.messageType?Object(g.jsx)(E,{msg:e.msg,custom:n}):"image"===e.msg.type?Object(g.jsx)(h,{msg:e.msg,custom:n}):Object(g.jsx)("div",{children:JSON.stringify(e.msg)})},v=function(e){return Object(g.jsx)(b,{msg:e.msg,user:e.custom.user,deleted:e.deleted,children:e.custom.text})},p=function(e){var t,n;return Object(g.jsxs)(b,{msg:e.msg,user:e.custom.user,deleted:e.deleted,children:["Sent ",null===(t=e.custom.giftInfo)||void 0===t?void 0:t.giftNum,"x ",null===(n=e.custom.giftInfo)||void 0===n?void 0:n.giftName]})},x=function(e){return Object(g.jsx)(b,{msg:e.msg,user:e.custom.user,deleted:e.deleted,children:Object(g.jsx)("img",{src:e.custom.emotionRemote,alt:""})})},E=function(e){return Object(g.jsxs)(b,{msg:e.msg,user:e.custom.user,deleted:e.deleted,children:[e.custom.text,Object(g.jsxs)("blockquote",{children:[e.custom.replyName,": ",e.custom.replyText]})]})},h=function(e){return Object(g.jsx)(b,{msg:e.msg,user:e.custom.user,deleted:e.deleted,children:Object(g.jsx)("img",{src:e.msg.file.url,alt:""})})},N=["chatweblink01.netease.im:443"],S=function(e){var t=Object(r.useState)(null),n=Object(d.a)(t,2),s=n[0],c=n[1],o=Object(r.useState)("OFFLINE"),i=Object(d.a)(o,2),j=i[0],f=i[1],b=Object(r.useState)([]),v=Object(d.a)(b,2),p=v[0],x=v[1],E=function(e){f("ONLINE"),console.log("ONLINE",e)},h=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.log("r",t)},S=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.log("d",t)},T=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.log("e",t)},y=function(e){x((function(t){var n=w(e,t,"dupNew");return[].concat(Object(m.a)(t),Object(m.a)(n))})),console.log(e)},w=function(e,t,n){var r=e.filter((function(e){return!e.resend})).map((function(e){return Object(l.a)(Object(l.a)({},e),{},{custom:JSON.parse(e.custom||null)})})),s=new Map(t.map((function(e,t){return[e.idClient,t]}))),c=r.map((function(e,t){return[t,e,s.get(e.idClient)]})),o=c.filter((function(e){var t=Object(d.a)(e,3);t[0],t[1];return void 0!==t[2]})).map((function(e){var n=Object(d.a)(e,3),r=n[0],s=n[1],c=n[2];return[r,s,c,t[c]]}));return o.length>0&&console.log(n,o),c.filter((function(e){var t=Object(d.a)(e,3);t[0],t[1];return void 0===t[2]})).map((function(e){var t=Object(d.a)(e,3),n=(t[0],t[1]);t[2];return n}))},C=function(){var e=Object(u.a)(a.a.mark((function e(t){var n,r,s,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.target.files[0]){e.next=4;break}return console.log("no file",t.target.files),e.abrupt("return");case 4:return console.log("loading",new Date),e.next=7,n.text();case 7:r=e.sent,e.prev=8,s=JSON.parse(r),e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(8),console.log("err parse",e.t0),e.abrupt("return");case 16:console.log("loaded",new Date),s.reverse(),c=w(s,[],"dupLoad"),console.log("rendering",new Date),x(c);case 21:case"end":return e.stop()}}),e,null,[[8,12]])})));return function(t){return e.apply(this,arguments)}}(),I=new Set(p.filter((function(e){var t;return"DELETE"===(null===(t=e.custom)||void 0===t?void 0:t.messageType)})).map((function(e){return e.custom.targetId})));return Object(g.jsxs)("div",{children:[Object(g.jsx)("header",{children:e.name}),Object(g.jsx)("input",{type:"file",onChange:C}),Object(g.jsx)("button",{onClick:function(){console.log(window.SDK),console.log(s),console.log(p),console.log(I)},children:"Debug"}),j,Object(g.jsx)("button",{onClick:function(){var t=window.SDK.Chatroom.getInstance({appKey:"632feff1f4c838541ab75195d1ceb3fa",isAnonymous:!0,chatroomNick:"RO",chatroomId:e.roomId,chatroomAddresses:N,onconnect:E,onwillreconnect:h,ondisconnect:S,onerror:T,onmsgs:y});c(t)},children:"Init"}),Object(g.jsx)("button",{onClick:function(){var e;s.getHistoryMsgs({timetag:null===(e=p[0])||void 0===e?void 0:e.time,done:function(e,t){if(e)console.log(e);else{var n=Object(m.a)(t.msgs);n.reverse(),x((function(e){var t=w(n,e,"dupHist");return[].concat(Object(m.a)(t),Object(m.a)(e))}))}}})},children:"Earlier"}),Object(g.jsx)("div",{children:p.map((function(e){return Object(g.jsx)("div",{className:"each",onClick:function(){return console.log(e)},children:Object(g.jsx)(O,{msg:e,deleted:I.has(e.idClient)})},e.idClient)}))})]})};var T=function(){return Object(g.jsx)("div",{className:"App",children:Object(g.jsx)(S,{roomId:"67362271",name:"Foo"})})},y=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,21)).then((function(t){var n=t.getCLS,r=t.getFID,s=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),r(e),s(e),c(e),o(e)}))};o.a.render(Object(g.jsx)(s.a.StrictMode,{children:Object(g.jsx)(T,{})}),document.getElementById("root")),y()}},[[20,1,2]]]);
//# sourceMappingURL=main.8008b9bc.chunk.js.map